# 修正内容の確認 (Walkthrough)

## 課題
13. 通知の権限がない状態（Not Determined）で「テスト通知」を押した際、何も起きずに終わってしまうため、許可ダイアログを出すようにしたい。

## 修正内容

### `SettingsView.swift`
- デバッグ用の「5秒後にテスト通知」ボタンのアクションを修正しました。
- **通知権限の自動要求**:
    - ボタンが押されたとき、ステータスが `.notDetermined` の場合は `requestAuthorization` を呼び出し、その場で許可を求めるようにしました。
    - `await` でユーザーの応答（許可/拒否）を待ってから、後続の通知予約処理に進みます。
    - もし `.denied`（拒否）状態や、リクエストで拒否された場合は、「通知が無効です」というアラートを表示して設定アプリへの誘導を促すようにしました。

## 確認手順
1.  **新規インストール状態（または権限リセット後）で確認**:
    - 「5秒後にテスト通知」をタップします。
    - システム標準の「通知を許可しますか？」ダイアログが表示されることを確認します。
    - 「許可」を選択すると、続けて「通知リクエストを登録しました」のログが出て、通知が届くことを確認します。
2.  **拒否状態で確認**:
    - 設定アプリで通知をオフにした後、再度ボタンをタップします。
    - アプリ内アラートで「通知が無効です」と表示されることを確認します。
